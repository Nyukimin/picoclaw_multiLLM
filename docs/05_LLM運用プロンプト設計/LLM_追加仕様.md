仕様
目的

CHATルート（Kuro）をデフォルトで「会話モード」にする

必要なときだけ「仕事モード」を一時的に強制し、一定ターンで自動解除する

1スレッド常時運用でも、重心を確実に切り替えられるようにする

既存の合成System（Identity + workspace/*.md + Memory + Skills）と、sessions履歴は維持する

用語

会話モード：通常状態。Kuroのキャラ設定（CHAT_PERSONA.md）に従う

仕事モード（Work Overlay）：直近入力に対して強い制約を一時付与する「上書き指示」。ターンTTLで消える

挙動（ユーザー体験）

通常：何も指定しない限り会話モード

仕事モードON：ユーザーが /work を送る

以後、次の N ターン（デフォルト 8ターン）だけ「仕事モード指示」が毎回注入される

仕事モードOFF：ユーザーが /normal（または /work off）を送ると即解除

仕事モード残ターン表示：/work status で残ターンを返す（LLMを呼ばずに即時返信）

コマンド仕様

/work：仕事モード ON（デフォルト N=8）

/work 12：仕事モード ON（N=12）

/work status：残ターン表示

/normal：仕事モード OFF（残ターン=0）

互換：/work off も /normal と同義にしてよい

仕事モード指示内容（短く強く）

仕事モード中、Kuroの返答は以下を優先する：

れんさんの意図とゴールを 1〜2文で要約

結論 → 2. 手順（必要時） → 3. 確認（1〜3件）

推測は推測と明示、不明は不明と言う

長文化しない（網羅を避ける）

追加提案は最大1件

実行していない操作を実行済みと言わない

機密を出さない

注入位置（重要）

仕事モード指示は system ではなく、毎回の current user message 直前に role=user の短い指示として挿入する。
理由：PicoClawは履歴＋systemが重いので、直近に置いた方が確実に効く。

TTLの消費ルール（ターン）

「LLMに問い合わせた回数」＝1ターンとしてカウント

仕事モードが有効な問い合わせを 1回行うごとに TurnsLeft--

0になったら自動解除

ルートとの関係

仕事モードは基本 CHATルートにのみ適用（Kuroの操縦性向上が目的）

ただし将来拡張として、/work を「PLANやOPSにデリゲートしやすくする」トリガにしてもよい（今回はやらない）

永続化

workspace/sessions/{sessionKey}.json に work_overlay_turns_left と work_overlay_directive を保存する

PicoClaw再起動後も残ターンが復元される

例外・安全

/work status や /normal は LLM呼び出し不要（即時レスポンス）

仕事モードの指示は短く固定文にして、プロンプト肥大を防ぐ
