# PicoClaw Worker→Coder エスカレーション仕様

## 1. 目的

生成品質が作業成功率に直結するタスクについて、Local Worker から Web
Coder へ適切にエスカレーションするための運用仕様を定義する。
目的は以下の3点である。

-   品質が必要な領域のみを高性能モデルに委譲する
-   コストと安定性のバランスを保つ
-   Web障害時でも最低限の作業継続を可能にする

------------------------------------------------------------------------

## 2. 役割定義

### 2.1 Worker（Local / Qwen2.5）

役割は「現場監督」。

担当範囲： - 依頼内容の分解 - 前提条件の整理 - 入出力形式の明確化 -
曖昧さ・矛盾の検出 - Coderに渡すプロンプトの構築

Workerは設計判断の最終決定を行わない。

------------------------------------------------------------------------

### 2.2 Coder（Web / ChatGPT・DeepSeek）

役割は「高品質生成エンジン」。

担当範囲： - 仕様策定の骨格設計 - 複雑な推論 - 曖昧要求の解消 -
代替案比較 - 実装方針の確定 - コード生成

------------------------------------------------------------------------

## 3. エスカレーション条件

Workerは以下の条件に該当した場合、Coderへ委譲する。

1.  目的・入力・出力が明確でない
2.  要求に論理矛盾がある
3.  システム構造設計が必要
4.  実装失敗のコストが高い
5.  推論ステップが多段になる
6.  要求が抽象的で定義が不足している

------------------------------------------------------------------------

## 4. ルーティング指針

### 4.1 Coder1（ChatGPT）

-   仕様設計
-   文書構造設計
-   論点整理
-   意思決定支援

### 4.2 Coder2（DeepSeek）

-   アルゴリズム設計
-   コード生成
-   実装詳細化
-   技術的具体化

------------------------------------------------------------------------

## 5. Worker→Coder 入力フォーマット

Workerは以下の構造でCoderへ入力を渡す。

### 必須項目

-   Goal（1文）
-   Known Facts（箇条書き）
-   Constraints（制約条件）
-   Required Output Format（出力形式指定）
-   Open Questions（不明点）

------------------------------------------------------------------------

## 6. 運用方針

-   Workerは常にデフォルト担当
-   Coderは必要時のみ呼び出す
-   Webが利用不能な場合、Workerは暫定仕様案を生成する
-   Coder出力はWorkerが再検証する

------------------------------------------------------------------------

## 7. 設計思想

本構成は以下を両立する。

-   安定性（Local主体）
-   品質（必要箇所のみWeb）
-   コスト制御
-   情報境界の維持

Workerは常にシステムの制御中心に置かれる。
